Please find the SQL Queries for AB testing 

Insert Statement for Control Table:
INSERT INTO   LANDINGDEV_MIGRATION.SHARED_SCHEMA.TEST_CONTROL_TABLE (APPLICATION_ID, MASTER_SEQUENCE, SOURCE_TYPE, SOURCE_DATABASE, SOURCE_SCHEMA, SOURCE_TABLE, TARGET_TYPE, TARGET_DATABASE, TARGET_SCHEMA, TARGET_TABLE, IGNORE_COLUMN, JOIN_CONDITION, NUMBER_OF_ROWS, SOURCE_FILE_LOCATION, TARGET_FILE_LOCATION, COMPARISON_OPTION, INPUT_FORMAT)
SELECT 
'HCBBMedical_103' APPLICATION_ID,
'TEST_MASTER' MASTER_SEQUENCE, 
'FILE' SOURCE_TYPE,
'EDRDEV_MIGRATION' SOURCE_DATABASE,
'EDR' SOURCE_SCHEMA,
'CCDH_WELLNESS_TEST' SOURCE_TABLE,
'FILE' TARGET_TYPE,
'EDRDEV_MIGRATION' TARGET_DATABASE,
'EDR' TARGET_SCHEMA,
'CCDH_WELLNESS_TEST' TARGET_TABLE, 
'(0,0),(0,0)' IGNORE_COLUMN, 
'$1' JOIN_CONDITION, 
'1000' NUMBER_OF_ROWS,
'steu2shdevmat01/test/HCBB_Medicalclaim_07032024/DS_BCBSRI_M01_LMHE_O_MTLY_MedicalClaims_20240304_050813_01.txt' SOURCE_FILE_LOCATION,
'steu2shdevmat01/datahub/demand/publish/HCBB/Medical_Claim/BCBSRI_D01_LMHE_O_MTLY_MedicalClaims_20240314_121934_01.txt' TARGET_FILE_LOCATION, 

NULL COMPARISON_OPTION, 
NULL INPUT_FORMAT;

Insert Statement for Control File:


INSERT INTO LANDINGDEV_MIGRATION.EDR_EDR.CTL_FILE_READ_WRITE (FILE_CONTROLID, APPLICATION_ID, FILE_NAME, FILE_TYPE, FILE_LOCATION, DELIMITER, COLUMNS, COLUMN_POSITIONS, ARCHIVE, ARCHIVE_LOCATION, RETENTION_PERIOD, TABLE_NAME, HEADER_YES_NO, HEADER_STRING)
SELECT '45' FILE_CONTROLID, 
'TEST1'  APPLICATION_ID,
'DS_BCBSRI_M01_LMHE_O_MTLY_MedicalClaims_20240304_050813_01.txt' FILE_NAME,
'FixedWidth' FILE_TYPE, 
'steu2shdevmat01/test/HCBB_Medicalclaim_07032024/' FILE_LOCATION, 
'~' DELIMITER,---here changed dilimiter
null  COLUMNS,
null  COLUMN_POSITIONS,
null  ARCHIVE,
null  ARCHIVE_LOCATION,
''  RETENTION_PERIOD, 
'' TABLE_NAME,
'NO' HEADER_YES_NO,
'' HEADER_STRING
UNION ALL
SELECT '46' FILE_CONTROLID, 
'TEST1'  APPLICATION_ID,
'BCBSRI_D01_LMHE_O_MTLY_MedicalClaims_20240314_121934_01.txt' FILE_NAME,
'FixedWidth' FILE_TYPE, 
'steu2shdevmat01/datahub/demand/publish/HCBB/Medical_Claim/'  FILE_LOCATION, 
'~' DELIMITER,---here changed dilimiter


null  COLUMNS,
null  COLUMN_POSITIONS,
null  ARCHIVE,
null  ARCHIVE_LOCATION,
'90'  RETENTION_PERIOD, 
'' TABLE_NAME,
'YES' HEADER_YES_NO,
'' HEADER_STRING;


Validation Query :
----------------------validation Query------

SELECT K.$1::varchar,L.$1::varchar,M.$1::varchar, 

K.SOURCE_FILE_LOCATION, L.FILE_LOCATION||L.FILE_NAME , 

K.TARGET_FILE_LOCATION, M.FILE_LOCATION||M.FILE_NAME , 

IFF(coalesce( K.$1::varchar,L.$1::varchar,M.$1::varchar) is null,'ENTRIES not correct','ENTRIES ARE JOINING WITH METADATA')  FROM LANDINGDEV_MIGRATION.SHARED_SCHEMA.TEST_CONTROL_TABLE  K   

left join LANDINGDEV_MIGRATION.EDR_EDR.CTL_FILE_READ_WRITE M on    

K.TARGET_FILE_LOCATION=M.FILE_LOCATION||M.FILE_NAME  

   left join LANDINGDEV_MIGRATION.EDR_EDR.CTL_FILE_READ_WRITE L on    

K.SOURCE_FILE_LOCATION=L.FILE_LOCATION||L.FILE_NAME  

where  K.APPLICATION_ID='HCBBMedical_103';


To see the Summary Table:

SELECT * FROM LANDINGDEV_MIGRATION.SHARED_SCHEMA.AB_TEST_SUMMARY where APPLICATION_ID='TEST_300';

To See the Detail record table:

SELECT * FROM LANDINGDEV_MIGRATION.SHARED_SCHEMA.AB_TEST_ROW_REJECT_DETAIL where test_run_id=255;


SELECT top 3 * FROM LANDINGDEV_MIGRATION.SHARED_SCHEMA.AB_TEST_SUMMARY order by 1 desc;

SELECT * FROM LANDINGDEV_MIGRATION.SHARED_SCHEMA.AB_TEST_ROW_REJECT_DETAIL where test_run_id=265;

